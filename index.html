<!DOCTYPE html>
<html>
    <head>
        <title>Setter</title>
        <script type="text/javascript" src="content/scripts/field.js"></script>
    </head>
    <body>
        <p>
            <b>Format:</b>
            <br/>
            If your dot is Side 2: 4 inside the 45 and 3 behind the front hash, enter:
            <br/>
            "S2 4I45" for X and "3BFH" for Y
            <br/>
            In general the format is "S(side) (steps)(I|O)(yard line)" for X and "(steps)(B|IFO)(FSL|FH|BH|BSL)" for Y.
            <br/>
            Yes, that means that if you're "on the 40" you must either put 0I40 or 0O40 for now.
            <br/><br/>
        </p>
        
        <!-- ex. side 1: 0 in from 45 -->
        <input type="text" placeholder="X steps" id="xsteps" />
        <!-- ex. 0 behind FSL -->
        <input type="text" placeholder="Y steps" id="ysteps" />
        
        <br/><br/>
        
        <input type="text" placeholder="X steps" id="xsteps2" />
        <input type="text" placeholder="Y steps" id="ysteps2" />
        <br/><br/>
        <button id="calc-btn">Calculate</button>
        <button id="next-btn">Next</button>
        
        <h3>Midset:</h3>
        <p id="midset-x"></p>
        <p id="midset-y"></p>

        <br/>

        <p id="hyp"></p>
        <canvas id="triangle"></canvas>
        
        <script type="text/javascript">
            var calcBtn = document.getElementById("calc-btn");
            var nextBtn = document.getElementById("next-btn");
            
            var canvas = document.getElementById("triangle");
            var ctx = canvas.getContext("2d");

            function drawTriangle(first, second) {
                var diff = Dot.difference(second, first);

                var scale = 10;
                var offset = 30;

                ctx.clearRect(0, 0, 500, 500);

                var triangle = {
                    y: offset + (Math.abs(diff.y) * scale),
                    x: offset + (Math.abs(diff.x) * scale)
                };

                var path = new Path2D();

                if (diff.x < 0) {
                    if (diff.y < 0) {
                        path.moveTo(offset, triangle.y); //Bottom left
                        path.lineTo(triangle.x, offset); //Top right
                    }

                    if (diff.y > 0) {
                        path.moveTo(offset, offset); //Top left
                        path.lineTo(offset, triangle.y); //Bottom left
                    }
                }

                if (diff.x > 0) {
                    if (diff.y > 0) {
                        path.moveTo(triangle.x, offset); //Top right
                        path.lineTo(offset, triangle.y); //Bottom left
                    }

                    if (diff.y < 0) {
                        path.moveTo(offset, offset); //Top left
                        path.lineTo(triangle.x, offset); //Top right
                    }
                }

                //Bottom right corner is in all possible triangles
                path.lineTo(triangle.x, triangle.y);

                ctx.fill(path);

                ctx.textBaseline = "top";
                ctx.font = "10px sans-serif";
                ctx.fillText(diff.y, 0, 50);
                ctx.fillText(diff.x, 75, 15);

                document.getElementById("hyp").textContent = Math.sqrt(Math.pow(diff.x, 2) + Math.pow(diff.y, 2));
            }

            calcBtn.onclick = function () {
                var firstSet = parseDot(document.getElementById("xsteps").value, document.getElementById("ysteps").value);
                var secondSet = parseDot(document.getElementById("xsteps2").value, document.getElementById("ysteps2").value);

                var halfSet = Dot.average(firstSet, secondSet);
                var prettyHalf = halfSet.prettify();
                document.getElementById("midset-x").textContent = prettyHalf.x;
                document.getElementById("midset-y").textContent = prettyHalf.y;
                drawTriangle(firstSet, secondSet);
            };
            
            nextBtn.onclick = function () {
                document.getElementById("xsteps").value = document.getElementById("xsteps2").value;
                document.getElementById("ysteps").value = document.getElementById("ysteps2").value;
                
                document.getElementById("xsteps2").value = "";
                document.getElementById("ysteps2").value = "";
            };
        </script>
    </body>
</html>